/**
 *	@file	unit_test_fnd_cmath_cyl_bessel_k.cpp
 *
 *	@brief	cyl_bessel_k のテスト
 *
 *	@author	myoukaku
 */

#include <bksge/fnd/cmath/cyl_bessel_k.hpp>
#include <bksge/fnd/cmath/isnan.hpp>
#include <bksge/fnd/cmath/abs.hpp>
#include <bksge/fnd/type_traits/is_same.hpp>
#include <gtest/gtest.h>
#include <limits>
#include "constexpr_test.hpp"

BKSGE_WARNING_PUSH();
BKSGE_WARNING_DISABLE_MSVC(4305);	// 'initializing': truncation from 'double' to 'T1'

namespace bksge_cmath_test
{

namespace cyl_bessel_k_test
{

static_assert(bksge::is_same<float,       decltype(bksge::cyl_bessel_k(0.0f, 0.0f))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0.0f, 0.0 ))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0f, 0.0l))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0.0f, 0   ))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0.0 , 0.0f))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0.0 , 0.0 ))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0 , 0.0l))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0.0 , 0   ))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0l, 0.0f))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0l, 0.0 ))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0l, 0.0l))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0.0l, 0   ))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0   , 0.0f))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0   , 0.0 ))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_k(0   , 0.0l))>::value, "");
static_assert(bksge::is_same<double,      decltype(bksge::cyl_bessel_k(0   , 0   ))>::value, "");
static_assert(bksge::is_same<float,       decltype(bksge::cyl_bessel_kf(0.0f, 0.0f))>::value, "");
static_assert(bksge::is_same<long double, decltype(bksge::cyl_bessel_kl(0.0l, 0.0l))>::value, "");

template <typename T1, typename T2>
void CylBesselKTest(double error)
{
	using Promoted = bksge::float_promote_t<T1, T2>;
	BKSGE_CONSTEXPR auto nan1 = std::numeric_limits<T1>::quiet_NaN();
	BKSGE_CONSTEXPR auto nan2 = std::numeric_limits<T2>::quiet_NaN();
	BKSGE_CONSTEXPR auto inf = std::numeric_limits<Promoted>::infinity();
	BKSGE_CONSTEXPR auto lowest = std::numeric_limits<Promoted>::lowest();
	BKSGE_CONSTEXPR auto max = std::numeric_limits<Promoted>::max();
	BKSGE_CONSTEXPR auto min = std::numeric_limits<Promoted>::min();

	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_k(nan1, nan2)));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_k(nan1, T2(0))));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_k(T1(0), nan2)));

	struct testcase
	{
		double expected;
		T1 nu;
		T2 x;
	};

	testcase const testcases[] =
	{
		{1.5415067512483025,    0.0000000000000000, 0.25000000000000000},
		{0.92441907122766565,   0.0000000000000000, 0.50000000000000000},
		{0.61058242211646430,   0.0000000000000000, 0.75000000000000000},
		{0.42102443824070834,   0.0000000000000000, 1.0000000000000000},
		{0.29760308908410588,   0.0000000000000000, 1.2500000000000000},
		{0.21380556264752565,   0.0000000000000000, 1.5000000000000000},
		{0.15537981238660359,   0.0000000000000000, 1.7500000000000000},
		{0.11389387274953360,   0.0000000000000000, 2.0000000000000000},
		{0.084043111974658191,  0.0000000000000000, 2.2500000000000000},
		{0.062347553200366168,  0.0000000000000000, 2.5000000000000000},
		{0.046454901308760774,  0.0000000000000000, 2.7500000000000000},
		{0.034739504386279256,  0.0000000000000000, 3.0000000000000000},
		{0.026058755255154966,  0.0000000000000000, 3.2500000000000000},
		{0.019598897170368501,  0.0000000000000000, 3.5000000000000000},
		{0.014774250877128707,  0.0000000000000000, 3.7500000000000000},
		{0.011159676085853030,  0.0000000000000000, 4.0000000000000000},
		{0.0084443877245429649, 0.0000000000000000, 4.2500000000000000},
		{0.0063998572432339756, 0.0000000000000000, 4.5000000000000000},
		{0.0048572045578879524, 0.0000000000000000, 4.7500000000000000},
		{0.0036910983340425947, 0.0000000000000000, 5.0000000000000000},

		{1.7144912564234513,    0.33333333333333333, 0.25000000000000000},
		{0.98903107424672421,   0.33333333333333333, 0.50000000000000000},
		{0.64216899667282989,   0.33333333333333333, 0.75000000000000000},
		{0.43843063344153443,   0.33333333333333333, 1.0000000000000000},
		{0.30788192414945043,   0.33333333333333333, 1.2500000000000000},
		{0.22015769026776688,   0.33333333333333333, 1.5000000000000000},
		{0.15943413057311243,   0.33333333333333333, 1.7500000000000000},
		{0.11654496129616534,   0.33333333333333333, 2.0000000000000000},
		{0.085809609306439674,  0.33333333333333333, 2.2500000000000000},
		{0.063542537454733386,  0.33333333333333333, 2.5000000000000000},
		{0.047273354184795509,  0.33333333333333333, 2.7500000000000000},
		{0.035305904902162587,  0.33333333333333333, 3.0000000000000000},
		{0.026454186892773169,  0.33333333333333333, 3.2500000000000000},
		{0.019877061407943805,  0.33333333333333333, 3.5000000000000000},
		{0.014971213514760216,  0.33333333333333333, 3.7500000000000000},
		{0.011299947573672166,  0.33333333333333333, 4.0000000000000000},
		{0.0085447959546110473, 0.33333333333333333, 4.2500000000000000},
		{0.0064720581217078245, 0.33333333333333333, 4.5000000000000000},
		{0.0049093342803275264, 0.33333333333333333, 4.7500000000000000},
		{0.0037288750960535887, 0.33333333333333333, 5.0000000000000000},

		{1.9521640631515476,    0.50000000000000000, 0.25000000000000000},
		{1.0750476034999195,    0.50000000000000000, 0.50000000000000000},
		{0.68361006034952432,   0.50000000000000000, 0.75000000000000000},
		{0.46106850444789443,   0.50000000000000000, 1.0000000000000000},
		{0.32117137397144746,   0.50000000000000000, 1.2500000000000000},
		{0.22833505222826550,   0.50000000000000000, 1.5000000000000000},
		{0.16463628997380861,   0.50000000000000000, 1.7500000000000000},
		{0.11993777196806145,   0.50000000000000000, 2.0000000000000000},
		{0.088065558803650454,  0.50000000000000000, 2.2500000000000000},
		{0.065065943154009986,  0.50000000000000000, 2.5000000000000000},
		{0.048315198301417825,  0.50000000000000000, 2.7500000000000000},
		{0.036025985131764589,  0.50000000000000000, 3.0000000000000000},
		{0.026956356532443351,  0.50000000000000000, 3.2500000000000000},
		{0.020229969578139294,  0.50000000000000000, 3.5000000000000000},
		{0.015220888252975568,  0.50000000000000000, 3.7500000000000000},
		{0.011477624576608053,  0.50000000000000000, 4.0000000000000000},
		{0.0086718932956978342, 0.50000000000000000, 4.2500000000000000},
		{0.0065633945646345424, 0.50000000000000000, 4.5000000000000000},
		{0.0049752435421262292, 0.50000000000000000, 4.7500000000000000},
		{0.0037766133746428825, 0.50000000000000000, 5.0000000000000000},

		{2.3289060745544101,    0.66666666666666666, 0.25000000000000000},
		{1.2059304647203353,    0.66666666666666666, 0.50000000000000000},
		{0.74547232976647226,   0.66666666666666666, 0.75000000000000000},
		{0.49447506210420811,   0.66666666666666666, 1.0000000000000000},
		{0.34062994813514252,   0.66666666666666666, 1.2500000000000000},
		{0.24024045240315581,   0.66666666666666666, 1.5000000000000000},
		{0.17217716908452307,   0.66666666666666666, 1.7500000000000000},
		{0.12483892748812841,   0.66666666666666666, 2.0000000000000000},
		{0.091315296079621050,  0.66666666666666666, 2.2500000000000000},
		{0.067255322171623361,  0.66666666666666666, 2.5000000000000000},
		{0.049809546542402224,  0.66666666666666666, 2.7500000000000000},
		{0.037057074495188531,  0.66666666666666666, 3.0000000000000000},
		{0.027674365504886729,  0.66666666666666666, 3.2500000000000000},
		{0.020733915836010912,  0.66666666666666666, 3.5000000000000000},
		{0.015577015510251336,  0.66666666666666666, 3.7500000000000000},
		{0.011730801456525337,  0.66666666666666666, 4.0000000000000000},
		{0.0088528343204658851, 0.66666666666666666, 4.2500000000000000},
		{0.0066933190915775568, 0.66666666666666666, 4.5000000000000000},
		{0.0050689292106255480, 0.66666666666666666, 4.7500000000000000},
		{0.0038444246344968226, 0.66666666666666666, 5.0000000000000000},

		{3.7470259744407115,    1.0000000000000000, 0.25000000000000000},
		{1.6564411200033007,    1.0000000000000000, 0.50000000000000000},
		{0.94958046696214016,   1.0000000000000000, 0.75000000000000000},
		{0.60190723019723458,   1.0000000000000000, 1.0000000000000000},
		{0.40212407978419540,   1.0000000000000000, 1.2500000000000000},
		{0.27738780045684375,   1.0000000000000000, 1.5000000000000000},
		{0.19547745347439305,   1.0000000000000000, 1.7500000000000000},
		{0.13986588181652262,   1.0000000000000000, 2.0000000000000000},
		{0.10121630256832535,   1.0000000000000000, 2.2500000000000000},
		{0.073890816347747038,  1.0000000000000000, 2.5000000000000000},
		{0.054318522758919859,  1.0000000000000000, 2.7500000000000000},
		{0.040156431128194198,  1.0000000000000000, 3.0000000000000000},
		{0.029825529796040143,  1.0000000000000000, 3.2500000000000000},
		{0.022239392925923845,  1.0000000000000000, 3.5000000000000000},
		{0.016638191754688916,  1.0000000000000000, 3.7500000000000000},
		{0.012483498887268437,  1.0000000000000000, 4.0000000000000000},
		{0.0093896806560432589, 1.0000000000000000, 4.2500000000000000},
		{0.0070780949089680918, 1.0000000000000000, 4.5000000000000000},
		{0.0053459218178228390, 1.0000000000000000, 4.7500000000000000},
		{0.0040446134454521655, 1.0000000000000000, 5.0000000000000000},

		{31.517714546773998,    2.0000000000000000, 0.25000000000000000},
		{7.5501835512408695,    2.0000000000000000, 0.50000000000000000},
		{3.1427970006821715,    2.0000000000000000, 0.75000000000000000},
		{1.6248388986351774,    2.0000000000000000, 1.0000000000000000},
		{0.94100161673881855,   2.0000000000000000, 1.2500000000000000},
		{0.58365596325665070,   2.0000000000000000, 1.5000000000000000},
		{0.37878261635733851,   2.0000000000000000, 1.7500000000000000},
		{0.25375975456605621,   2.0000000000000000, 2.0000000000000000},
		{0.17401315870205850,   2.0000000000000000, 2.2500000000000000},
		{0.12146020627856381,   2.0000000000000000, 2.5000000000000000},
		{0.085959281497066137,  2.0000000000000000, 2.7500000000000000},
		{0.061510458471742059,  2.0000000000000000, 3.0000000000000000},
		{0.044412927437333515,  2.0000000000000000, 3.2500000000000000},
		{0.032307121699467839,  2.0000000000000000, 3.5000000000000000},
		{0.023647953146296131,  2.0000000000000000, 3.7500000000000000},
		{0.017401425529487247,  2.0000000000000000, 4.0000000000000000},
		{0.012863060974445674,  2.0000000000000000, 4.2500000000000000},
		{0.0095456772027753493, 2.0000000000000000, 4.5000000000000000},
		{0.0071081190074975690, 2.0000000000000000, 4.7500000000000000},
		{0.0053089437122234608, 2.0000000000000000, 5.0000000000000000},

		{391683.98962334893,   5.0000000000000000, 0.25000000000000000},
		{12097.979476096394,   5.0000000000000000, 0.50000000000000000},
		{1562.5870339691098,   5.0000000000000000, 0.75000000000000000},
		{360.96058960124071,   5.0000000000000000, 1.0000000000000000},
		{114.29321426334016,   5.0000000000000000, 1.2500000000000000},
		{44.067781159301056,   5.0000000000000000, 1.5000000000000000},
		{19.426568687730288,   5.0000000000000000, 1.7500000000000000},
		{9.4310491005964820,   5.0000000000000000, 2.0000000000000000},
		{4.9221270549918685,   5.0000000000000000, 2.2500000000000000},
		{2.7168842907865423,   5.0000000000000000, 2.5000000000000000},
		{1.5677685890536335,   5.0000000000000000, 2.7500000000000000},
		{0.93777360238680818,  5.0000000000000000, 3.0000000000000000},
		{0.57775534736785106,  5.0000000000000000, 3.2500000000000000},
		{0.36482440208451983,  5.0000000000000000, 3.5000000000000000},
		{0.23520290620082260,  5.0000000000000000, 3.7500000000000000},
		{0.15434254872599726,  5.0000000000000000, 4.0000000000000000},
		{0.10283347176876455,  5.0000000000000000, 4.2500000000000000},
		{0.069423643150881773, 5.0000000000000000, 4.5000000000000000},
		{0.047410616917942211, 5.0000000000000000, 4.7500000000000000},
		{0.032706273712031865, 5.0000000000000000, 5.0000000000000000},

		{194481817927839.88, 10.000000000000000, 0.25000000000000000},
		{188937569319.90030, 10.000000000000000, 0.50000000000000000},
		{3248187687.8018155, 10.000000000000000, 0.75000000000000000},
		{180713289.90102944, 10.000000000000000, 1.0000000000000000},
		{19104425.945252180, 10.000000000000000, 1.2500000000000000},
		{3027483.5236822353, 10.000000000000000, 1.5000000000000000},
		{633724.71555087867, 10.000000000000000, 1.7500000000000000},
		{162482.40397955943, 10.000000000000000, 2.0000000000000000},
		{48602.446087749791, 10.000000000000000, 2.2500000000000000},
		{16406.916416341937, 10.000000000000000, 2.5000000000000000},
		{6104.1720745909606, 10.000000000000000, 2.7500000000000000},
		{2459.6204220569480, 10.000000000000000, 3.0000000000000000},
		{1059.2358443703381, 10.000000000000000, 3.2500000000000000},
		{482.53582096664758, 10.000000000000000, 3.5000000000000000},
		{230.64249314993782, 10.000000000000000, 3.7500000000000000},
		{114.91408364049623, 10.000000000000000, 4.0000000000000000},
		{59.361613632706479, 10.000000000000000, 4.2500000000000000},
		{31.652958759229872, 10.000000000000000, 4.5000000000000000},
		{17.357723966417399, 10.000000000000000, 4.7500000000000000},
		{9.7585628291778121, 10.000000000000000, 5.0000000000000000},

		{7.0065983661641184e+34, 20.000000000000000, 0.25000000000000000},
		{6.6655498744171593e+28, 20.000000000000000, 0.50000000000000000},
		{1.9962989615380379e+25, 20.000000000000000, 0.75000000000000000},
		{6.2943693604245335e+22, 20.000000000000000, 1.0000000000000000},
		{7.2034511920074182e+20, 20.000000000000000, 1.2500000000000000},
		{1.8620549984645546e+19, 20.000000000000000, 1.5000000000000000},
		{8.4415605303952486e+17, 20.000000000000000, 1.7500000000000000},
		{57708568527002520.,     20.000000000000000, 2.0000000000000000},
		{5396824209986879.0,     20.000000000000000, 2.2500000000000000},
		{645996884063683.62,     20.000000000000000, 2.5000000000000000},
		{94387401970996.328,     20.000000000000000, 2.7500000000000000},
		{16254643952204.371,     20.000000000000000, 3.0000000000000000},
		{3212694836166.4053,     20.000000000000000, 3.2500000000000000},
		{713857897923.74072,     20.000000000000000, 3.5000000000000000},
		{175423421958.35925,     20.000000000000000, 3.7500000000000000},
		{47050078926.298088,     20.000000000000000, 4.0000000000000000},
		{13625066095.067503,     20.000000000000000, 4.2500000000000000},
		{4222179870.6810660,     20.000000000000000, 4.5000000000000000},
		{1389634112.7516634,     20.000000000000000, 4.7500000000000000},
		{482700052.06214869,     20.000000000000000, 5.0000000000000000},

		{4.3394604622138714e+107, 50.000000000000000, 0.25000000000000000},
		{3.8505298918269003e+92,  50.000000000000000, 0.50000000000000000},
		{6.0292756894842793e+83,  50.000000000000000, 0.75000000000000000},
		{3.4068968541617001e+77,  50.000000000000000, 1.0000000000000000},
		{4.8485527365039051e+72,  50.000000000000000, 1.2500000000000000},
		{5.3091717574907920e+68,  50.000000000000000, 1.5000000000000000},
		{2.3762245257445824e+65,  50.000000000000000, 1.7500000000000000},
		{2.9799817396049268e+62,  50.000000000000000, 2.0000000000000000},
		{8.2079431233488581e+59,  50.000000000000000, 2.2500000000000000},
		{4.2046528212987503e+57,  50.000000000000000, 2.5000000000000000},
		{3.5578676911884825e+55,  50.000000000000000, 2.7500000000000000},
		{4.5559542293221535e+53,  50.000000000000000, 3.0000000000000000},
		{8.2606735967628997e+51,  50.000000000000000, 3.2500000000000000},
		{2.0139406747903812e+50,  50.000000000000000, 3.5000000000000000},
		{6.3368727837484613e+48,  50.000000000000000, 3.7500000000000000},
		{2.4897317389325757e+47,  50.000000000000000, 4.0000000000000000},
		{1.1888958173039699e+46,  50.000000000000000, 4.2500000000000000},
		{6.7472593648148550e+44,  50.000000000000000, 4.5000000000000000},
		{4.4664266585930700e+43,  50.000000000000000, 4.7500000000000000},
		{3.3943222434301628e+42,  50.000000000000000, 5.0000000000000000},

		{9.5039428115809898e+245, 100.00000000000000, 0.25000000000000000},
		{7.4937399313533112e+215, 100.00000000000000, 0.50000000000000000},
		{1.8417471020730699e+198, 100.00000000000000, 0.75000000000000000},
		{5.9003331836386410e+185, 100.00000000000000, 1.0000000000000000},
		{1.2002130935576950e+176, 100.00000000000000, 1.2500000000000000},
		{1.4467044226487075e+168, 100.00000000000000, 1.5000000000000000},
		{2.9161498411497642e+161, 100.00000000000000, 1.7500000000000000},
		{4.6194159776013925e+155, 100.00000000000000, 2.0000000000000000},
		{3.5332121583541727e+150, 100.00000000000000, 2.2500000000000000},
		{9.3566097231039940e+145, 100.00000000000000, 2.5000000000000000},
		{6.7672283615134532e+141, 100.00000000000000, 2.7500000000000000},
		{1.1219630864949494e+138, 100.00000000000000, 3.0000000000000000},
		{3.7329723699990903e+134, 100.00000000000000, 3.2500000000000000},
		{2.2476893883855163e+131, 100.00000000000000, 3.5000000000000000},
		{2.2564559319883200e+128, 100.00000000000000, 3.7500000000000000},
		{3.5353340499626463e+125, 100.00000000000000, 4.0000000000000000},
		{8.1898439213010234e+122, 100.00000000000000, 4.2500000000000000},
		{2.6823744110726800e+120, 100.00000000000000, 4.5000000000000000},
		{1.1963963615212274e+118, 100.00000000000000, 4.7500000000000000},
		{7.0398601930616815e+115, 100.00000000000000, 5.0000000000000000},

		{0.0036910983340425947,  0.0000000000000000, 5.0000000000000000},
		{1.7780062316167647e-05, 0.0000000000000000, 10.000000000000000},
		{9.8195364823964333e-08, 0.0000000000000000, 15.000000000000000},
		{5.7412378153365238e-10, 0.0000000000000000, 20.000000000000000},
		{3.4641615622131151e-12, 0.0000000000000000, 25.000000000000000},
		{2.1324774964630566e-14, 0.0000000000000000, 30.000000000000000},
		{1.3310351491429464e-16, 0.0000000000000000, 35.000000000000000},
		{8.3928611000995700e-19, 0.0000000000000000, 40.000000000000000},
		{5.3334561226187247e-21, 0.0000000000000000, 45.000000000000000},
		{3.4101677497894956e-23, 0.0000000000000000, 50.000000000000000},
		{2.1913102183534147e-25, 0.0000000000000000, 55.000000000000000},
		{1.4138978405591074e-27, 0.0000000000000000, 60.000000000000000},
		{9.1544673210030045e-30, 0.0000000000000000, 65.000000000000000},
		{5.9446613372925013e-32, 0.0000000000000000, 70.000000000000000},
		{3.8701170455869113e-34, 0.0000000000000000, 75.000000000000000},
		{2.5251198425054720e-36, 0.0000000000000000, 80.000000000000000},
		{1.6507623579783908e-38, 0.0000000000000000, 85.000000000000000},
		{1.0810242556984256e-40, 0.0000000000000000, 90.000000000000000},
		{7.0901249699001278e-43, 0.0000000000000000, 95.000000000000000},
		{4.6566282291759025e-45, 0.0000000000000000, 100.00000000000000},

		{0.0037288750960535887,  0.33333333333333333, 5.0000000000000000},
		{1.7874608271055336e-05, 0.33333333333333333, 10.000000000000000},
		{9.8548341568798317e-08, 0.33333333333333333, 15.000000000000000},
		{5.7568278247790865e-10, 0.33333333333333333, 20.000000000000000},
		{3.4717201424907059e-12, 0.33333333333333333, 25.000000000000000},
		{2.1363664736611189e-14, 0.33333333333333333, 30.000000000000000},
		{1.3331202314165813e-16, 0.33333333333333333, 35.000000000000000},
		{8.4043837769480934e-19, 0.33333333333333333, 40.000000000000000},
		{5.3399731261024948e-21, 0.33333333333333333, 45.000000000000000},
		{3.4139217813583632e-23, 0.33333333333333333, 50.000000000000000},
		{2.1935050179185627e-25, 0.33333333333333333, 55.000000000000000},
		{1.4151968805623662e-27, 0.33333333333333333, 60.000000000000000},
		{9.1622357217019043e-30, 0.33333333333333333, 65.000000000000000},
		{5.9493479703461315e-32, 0.33333333333333333, 70.000000000000000},
		{3.8729660011055947e-34, 0.33333333333333333, 75.000000000000000},
		{2.5268631828013874e-36, 0.33333333333333333, 80.000000000000000},
		{1.6518353676138867e-38, 0.33333333333333333, 85.000000000000000},
		{1.0816880942511494e-40, 0.33333333333333333, 90.000000000000000},
		{7.0942508599231512e-43, 0.33333333333333333, 95.000000000000000},
		{4.6592031570213448e-45, 0.33333333333333333, 100.00000000000000},

		{0.0037766133746428825,  0.50000000000000000, 5.0000000000000000},
		{1.7993478093705178e-05, 0.50000000000000000, 10.000000000000000},
		{9.8991312032877236e-08, 0.50000000000000000, 15.000000000000000},
		{5.7763739747074450e-10, 0.50000000000000000, 20.000000000000000},
		{3.4811912768406949e-12, 0.50000000000000000, 25.000000000000000},
		{2.1412375659560111e-14, 0.50000000000000000, 30.000000000000000},
		{1.3357311366035824e-16, 0.50000000000000000, 35.000000000000000},
		{8.4188091949489049e-19, 0.50000000000000000, 40.000000000000000},
		{5.3481305002517408e-21, 0.50000000000000000, 45.000000000000000},
		{3.4186200954570754e-23, 0.50000000000000000, 50.000000000000000},
		{2.1962515908772453e-25, 0.50000000000000000, 55.000000000000000},
		{1.4168223500353693e-27, 0.50000000000000000, 60.000000000000000},
		{9.1719554473256892e-30, 0.50000000000000000, 65.000000000000000},
		{5.9552114337788932e-32, 0.50000000000000000, 70.000000000000000},
		{3.8765301321409432e-34, 0.50000000000000000, 75.000000000000000},
		{2.5290440439442907e-36, 0.50000000000000000, 80.000000000000000},
		{1.6531776067605980e-38, 0.50000000000000000, 85.000000000000000},
		{1.0825184636529955e-40, 0.50000000000000000, 90.000000000000000},
		{7.0994115873258822e-43, 0.50000000000000000, 95.000000000000000},
		{4.6624238126346709e-45, 0.50000000000000000, 100.00000000000000},

		{0.0038444246344968226,  0.66666666666666666, 5.0000000000000000},
		{1.8161187569530204e-05, 0.66666666666666666, 10.000000000000000},
		{9.9614751542305571e-08, 0.66666666666666666, 15.000000000000000},
		{5.8038484271925811e-10, 0.66666666666666666, 20.000000000000000},
		{3.4944937498488603e-12, 0.66666666666666666, 25.000000000000000},
		{2.1480755645577720e-14, 0.66666666666666666, 30.000000000000000},
		{1.3393949190152161e-16, 0.66666666666666666, 35.000000000000000},
		{8.4390460553642992e-19, 0.66666666666666666, 40.000000000000000},
		{5.3595716143622089e-21, 0.66666666666666666, 45.000000000000000},
		{3.4252085301433749e-23, 0.66666666666666666, 50.000000000000000},
		{2.2001025377982308e-25, 0.66666666666666666, 55.000000000000000},
		{1.4191011274172078e-27, 0.66666666666666666, 60.000000000000000},
		{9.1855803020269763e-30, 0.66666666666666666, 65.000000000000000},
		{5.9634299472578764e-32, 0.66666666666666666, 70.000000000000000},
		{3.8815254026478500e-34, 0.66666666666666666, 75.000000000000000},
		{2.5321003991943847e-36, 0.66666666666666666, 80.000000000000000},
		{1.6550585670593067e-38, 0.66666666666666666, 85.000000000000000},
		{1.0836820479428605e-40, 0.66666666666666666, 90.000000000000000},
		{7.1066428916285356e-43, 0.66666666666666666, 95.000000000000000},
		{4.6669364587280459e-45, 0.66666666666666666, 100.00000000000000},

		{0.0040446134454521655,  1.0000000000000000, 5.0000000000000000},
		{1.8648773453825579e-05, 1.0000000000000000, 10.000000000000000},
		{1.0141729369762091e-07, 1.0000000000000000, 15.000000000000000},
		{5.8830579695570384e-10, 1.0000000000000000, 20.000000000000000},
		{3.5327780731999345e-12, 1.0000000000000000, 25.000000000000000},
		{2.1677320018915498e-14, 1.0000000000000000, 30.000000000000000},
		{1.3499178340011053e-16, 1.0000000000000000, 35.000000000000000},
		{8.4971319548610435e-19, 1.0000000000000000, 40.000000000000000},
		{5.3923945937225035e-21, 1.0000000000000000, 45.000000000000000},
		{3.4441022267175555e-23, 1.0000000000000000, 50.000000000000000},
		{2.2111422716117463e-25, 1.0000000000000000, 55.000000000000000},
		{1.4256320265171041e-27, 1.0000000000000000, 60.000000000000000},
		{9.2246195278906156e-30, 1.0000000000000000, 65.000000000000000},
		{5.9869736739138550e-32, 1.0000000000000000, 70.000000000000000},
		{3.8958329467421912e-34, 1.0000000000000000, 75.000000000000000},
		{2.5408531275211705e-36, 1.0000000000000000, 80.000000000000000},
		{1.6604444948567571e-38, 1.0000000000000000, 85.000000000000000},
		{1.0870134457498335e-40, 1.0000000000000000, 90.000000000000000},
		{7.1273442329907240e-43, 1.0000000000000000, 95.000000000000000},
		{4.6798537356369088e-45, 1.0000000000000000, 100.00000000000000},

		{0.0053089437122234608,  2.0000000000000000, 5.0000000000000000},
		{2.1509817006932763e-05, 2.0000000000000000, 10.000000000000000},
		{1.1171767065031378e-07, 2.0000000000000000, 15.000000000000000},
		{6.3295436122922281e-10, 2.0000000000000000, 20.000000000000000},
		{3.7467838080691102e-12, 2.0000000000000000, 25.000000000000000},
		{2.2769929632558265e-14, 2.0000000000000000, 30.000000000000000},
		{1.4081733110858665e-16, 2.0000000000000000, 35.000000000000000},
		{8.8177176978426223e-19, 2.0000000000000000, 40.000000000000000},
		{5.5731181045619470e-21, 2.0000000000000000, 45.000000000000000},
		{3.5479318388581979e-23, 2.0000000000000000, 50.000000000000000},
		{2.2717153918665688e-25, 2.0000000000000000, 55.000000000000000},
		{1.4614189081096777e-27, 2.0000000000000000, 60.000000000000000},
		{9.4383017680150234e-30, 2.0000000000000000, 65.000000000000000},
		{6.1157177279757537e-32, 2.0000000000000000, 70.000000000000000},
		{3.9740059241667034e-34, 2.0000000000000000, 75.000000000000000},
		{2.5886411706935012e-36, 2.0000000000000000, 80.000000000000000},
		{1.6898316402103142e-38, 2.0000000000000000, 85.000000000000000},
		{1.1051801100484218e-40, 2.0000000000000000, 90.000000000000000},
		{7.2401743221736176e-43, 2.0000000000000000, 95.000000000000000},
		{4.7502253038886407e-45, 2.0000000000000000, 100.00000000000000},

		{0.032706273712031865,   5.0000000000000000, 5.0000000000000000},
		{5.7541849985312275e-05, 5.0000000000000000, 10.000000000000000},
		{2.1878261369258224e-07, 5.0000000000000000, 15.000000000000000},
		{1.0538660139974233e-09, 5.0000000000000000, 20.000000000000000},
		{5.6485921365284157e-12, 5.0000000000000000, 25.000000000000000},
		{3.2103335105890266e-14, 5.0000000000000000, 30.000000000000000},
		{1.8919208406439644e-16, 5.0000000000000000, 35.000000000000000},
		{1.1423814375953188e-18, 5.0000000000000000, 40.000000000000000},
		{7.0181216822204101e-21, 5.0000000000000000, 45.000000000000000},
		{4.3671822541009859e-23, 5.0000000000000000, 50.000000000000000},
		{2.7444967640357869e-25, 5.0000000000000000, 55.000000000000000},
		{1.7382232741886986e-27, 5.0000000000000000, 60.000000000000000},
		{1.1078474298959669e-29, 5.0000000000000000, 65.000000000000000},
		{7.0974537081794416e-32, 5.0000000000000000, 70.000000000000000},
		{4.5667269500061064e-34, 5.0000000000000000, 75.000000000000000},
		{2.9491764420206146e-36, 5.0000000000000000, 80.000000000000000},
		{1.9105685973117463e-38, 5.0000000000000000, 85.000000000000000},
		{1.2411034311592645e-40, 5.0000000000000000, 90.000000000000000},
		{8.0814211331379146e-43, 5.0000000000000000, 95.000000000000000},
		{5.2732561132929503e-45, 5.0000000000000000, 100.00000000000000},

		{9.7585628291778121,     10.000000000000000, 5.0000000000000000},
		{0.0016142553003906698,  10.000000000000000, 10.000000000000000},
		{2.2605303776606435e-06, 10.000000000000000, 15.000000000000000},
		{6.3162145283215804e-09, 10.000000000000000, 20.000000000000000},
		{2.4076769602801233e-11, 10.000000000000000, 25.000000000000000},
		{1.0842816942222975e-13, 10.000000000000000, 30.000000000000000},
		{5.3976770429777191e-16, 10.000000000000000, 35.000000000000000},
		{2.8680293113671932e-18, 10.000000000000000, 40.000000000000000},
		{1.5939871900169600e-20, 10.000000000000000, 45.000000000000000},
		{9.1509882099879962e-23, 10.000000000000000, 50.000000000000000},
		{5.3823846249592858e-25, 10.000000000000000, 55.000000000000000},
		{3.2253408700563144e-27, 10.000000000000000, 60.000000000000000},
		{1.9613367530075138e-29, 10.000000000000000, 65.000000000000000},
		{1.2068471495933484e-31, 10.000000000000000, 70.000000000000000},
		{7.4979152649449644e-34, 10.000000000000000, 75.000000000000000},
		{4.6957285830490531e-36, 10.000000000000000, 80.000000000000000},
		{2.9606323347034079e-38, 10.000000000000000, 85.000000000000000},
		{1.8773542561131613e-40, 10.000000000000000, 90.000000000000000},
		{1.1962899527846350e-42, 10.000000000000000, 95.000000000000000},
		{7.6554279773881006e-45, 10.000000000000000, 100.00000000000000},

		{482700052.06214869,     20.000000000000000, 5.0000000000000000},
		{178.74427820770543,     20.000000000000000, 10.000000000000000},
		{0.012141257729731143,   20.000000000000000, 15.000000000000000},
		{5.5431116361258155e-06, 20.000000000000000, 20.000000000000000},
		{6.3744029330352113e-09, 20.000000000000000, 25.000000000000000},
		{1.2304516475442478e-11, 20.000000000000000, 30.000000000000000},
		{3.2673136479809018e-14, 20.000000000000000, 35.000000000000000},
		{1.0703023799997383e-16, 20.000000000000000, 40.000000000000000},
		{4.0549953175660457e-19, 20.000000000000000, 45.000000000000000},
		{1.7061483797220349e-21, 20.000000000000000, 50.000000000000000},
		{7.7617008115659413e-24, 20.000000000000000, 55.000000000000000},
		{3.7482954006874720e-26, 20.000000000000000, 60.000000000000000},
		{1.8966880763956576e-28, 20.000000000000000, 65.000000000000000},
		{9.9615763479998864e-31, 20.000000000000000, 70.000000000000000},
		{5.3921623063091066e-33, 20.000000000000000, 75.000000000000000},
		{2.9920407657642266e-35, 20.000000000000000, 80.000000000000000},
		{1.6948662723618255e-37, 20.000000000000000, 85.000000000000000},
		{9.7689149642963042e-40, 20.000000000000000, 90.000000000000000},
		{5.7143603019220823e-42, 20.000000000000000, 95.000000000000000},
		{3.3852054148901695e-44, 20.000000000000000, 100.00000000000000},

		{3.3943222434301628e+42, 50.000000000000000, 5.0000000000000000},
		{2.0613737753892554e+27, 50.000000000000000, 10.000000000000000},
		{1.7267736974519188e+18, 50.000000000000000, 15.000000000000000},
		{411711209122.01788,     50.000000000000000, 20.000000000000000},
		{1972478.7419813874,     50.000000000000000, 25.000000000000000},
		{58.770686258007267,     50.000000000000000, 30.000000000000000},
		{0.0058659391182535178,  50.000000000000000, 35.000000000000000},
		{1.3634854128794101e-06, 50.000000000000000, 40.000000000000000},
		{5.8652396362160819e-10, 50.000000000000000, 45.000000000000000},
		{4.0060134766400893e-13, 50.000000000000000, 50.000000000000000},
		{3.9062324485711016e-16, 50.000000000000000, 55.000000000000000},
		{5.0389298085176510e-19, 50.000000000000000, 60.000000000000000},
		{8.1305344250110424e-22, 50.000000000000000, 65.000000000000000},
		{1.5732816234948991e-24, 50.000000000000000, 70.000000000000000},
		{3.5349854993874412e-27, 50.000000000000000, 75.000000000000000},
		{8.9940101003189471e-30, 50.000000000000000, 80.000000000000000},
		{2.5403205503080723e-32, 50.000000000000000, 85.000000000000000},
		{7.8397596486715721e-35, 50.000000000000000, 90.000000000000000},
		{2.6098900651329542e-37, 50.000000000000000, 95.000000000000000},
		{9.2745226536133242e-40, 50.000000000000000, 100.00000000000000},

		{7.0398601930616815e+115, 100.00000000000000, 5.0000000000000000},
		{4.5966740842695231e+85,  100.00000000000000, 10.000000000000000},
		{8.2565552242653946e+67,  100.00000000000000, 15.000000000000000},
		{1.7081356456876041e+55,  100.00000000000000, 20.000000000000000},
		{1.9858028128780610e+45,  100.00000000000000, 25.000000000000000},
		{1.2131584253026677e+37,  100.00000000000000, 30.000000000000000},
		{1.1016916354696688e+30,  100.00000000000000, 35.000000000000000},
		{7.0074023297775712e+23,  100.00000000000000, 40.000000000000000},
		{1.9236643958470894e+18,  100.00000000000000, 45.000000000000000},
		{16394035276269.250,      100.00000000000000, 50.000000000000000},
		{343254952.89495474,      100.00000000000000, 55.000000000000000},
		{14870.012754946298,      100.00000000000000, 60.000000000000000},
		{1.1708099078572216,      100.00000000000000, 65.000000000000000},
		{0.00015161193930722313,  100.00000000000000, 70.000000000000000},
		{2.9850234381623443e-08,  100.00000000000000, 75.000000000000000},
		{8.3928710724649113e-12,  100.00000000000000, 80.000000000000000},
		{3.2033435630927732e-15,  100.00000000000000, 85.000000000000000},
		{1.5922281431788096e-18,  100.00000000000000, 90.000000000000000},
		{9.9589454577674131e-22,  100.00000000000000, 95.000000000000000},
		{7.6171296304940831e-25,  100.00000000000000, 100.00000000000000},
	};

	for (auto data : testcases)
	{
		auto const r = bksge::cyl_bessel_k(data.nu, data.x);

		if (data.expected > max)
		{
			EXPECT_EQ(+inf, r);
		}
		else if (data.expected < lowest)
		{
			EXPECT_EQ(-inf, r);
		}
		else if (0 <= data.expected && data.expected < min)
		{
			EXPECT_GT(min, r);
		}
		else
		{
			double tole = bksge::abs(data.expected) * error;
			EXPECT_NEAR(data.expected, (double)r, tole);
		}
	}
}

GTEST_TEST(CMathTest, CylBesselKTest)
{
	CylBesselKTest<float,       float>      (1.0);
	CylBesselKTest<float,       double>     (0.00001);
	CylBesselKTest<float,       long double>(0.00001);
	CylBesselKTest<double,      float>      (0.0000000001);
	CylBesselKTest<double,      double>     (0.0000000001);
	CylBesselKTest<double,      long double>(0.0000000001);
	CylBesselKTest<long double, float>      (0.0000000001);
	CylBesselKTest<long double, double>     (0.0000000001);
	CylBesselKTest<long double, long double>(0.0000000001);

	BKSGE_CONSTEXPR auto nanf = std::numeric_limits<float>::quiet_NaN();
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kf(nanf, nanf)));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kf(nanf, 0.0f)));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kf(0.0f, nanf)));

	BKSGE_CONSTEXPR auto nanl = std::numeric_limits<long double>::quiet_NaN();
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kl(nanl, nanl)));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kl(nanl, 0.0l)));
	BKSGE_CXX14_CONSTEXPR_EXPECT_TRUE(bksge::isnan(bksge::cyl_bessel_kl(0.0l, nanl)));
}

}	// namespace cyl_bessel_k_test

}	// namespace bksge_cmath_test

BKSGE_WARNING_POP();
